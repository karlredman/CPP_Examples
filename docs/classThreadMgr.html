<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Various C++ Examples (including IPC): ThreadMgr Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Various C++ Examples (including IPC)
   &#160;<span id="projectnumber">Version: 1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classThreadMgr.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classThreadMgr-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ThreadMgr Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A basic thread management class.  
 <a href="classThreadMgr.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for ThreadMgr:</div>
<div class="dyncontent">
<div class="center"><img src="classThreadMgr__coll__graph.png" border="0" usemap="#ThreadMgr_coll__map" alt="Collaboration graph"/></div>
<map name="ThreadMgr_coll__map" id="ThreadMgr_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structThreadMgr_1_1func__arguments.html">func_arguments</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">structure for static wrapper function arguments  <a href="structThreadMgr_1_1func__arguments.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afe858b6d5ea9c7acb604c0ff9125acf6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#afe858b6d5ea9c7acb604c0ff9125acf6">ThreadMgr</a> ()</td></tr>
<tr class="memdesc:afe858b6d5ea9c7acb604c0ff9125acf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#afe858b6d5ea9c7acb604c0ff9125acf6">More...</a><br /></td></tr>
<tr class="separator:afe858b6d5ea9c7acb604c0ff9125acf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad731b9dbd261bc4665bad0b40a3db1eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#ad731b9dbd261bc4665bad0b40a3db1eb">cancel_thread</a> (pthread_t *tid)</td></tr>
<tr class="memdesc:ad731b9dbd261bc4665bad0b40a3db1eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">cancel a thread  <a href="#ad731b9dbd261bc4665bad0b40a3db1eb">More...</a><br /></td></tr>
<tr class="separator:ad731b9dbd261bc4665bad0b40a3db1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab27dc1197d7c3955d1b7e2a529a0a40e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#ab27dc1197d7c3955d1b7e2a529a0a40e">condWait</a> (void **thread_return_val)</td></tr>
<tr class="memdesc:ab27dc1197d7c3955d1b7e2a529a0a40e"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait on a condition variable for a thread to terminate  <a href="#ab27dc1197d7c3955d1b7e2a529a0a40e">More...</a><br /></td></tr>
<tr class="separator:ab27dc1197d7c3955d1b7e2a529a0a40e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed679cee8b5f8308486800e44110299"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#aeed679cee8b5f8308486800e44110299">createThread</a> (void *(*thread_func)(void *), void *arg)</td></tr>
<tr class="memdesc:aeed679cee8b5f8308486800e44110299"><td class="mdescLeft">&#160;</td><td class="mdescRight">attempt to create a new thread and register it  <a href="#aeed679cee8b5f8308486800e44110299">More...</a><br /></td></tr>
<tr class="separator:aeed679cee8b5f8308486800e44110299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b1d99fa66ff17daea44b1defe43810"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a85b1d99fa66ff17daea44b1defe43810">threadsActive</a> ()</td></tr>
<tr class="memdesc:a85b1d99fa66ff17daea44b1defe43810"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the number of active threads  <a href="#a85b1d99fa66ff17daea44b1defe43810">More...</a><br /></td></tr>
<tr class="separator:a85b1d99fa66ff17daea44b1defe43810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406fff78718eca2fdcd25d856b949ce7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a406fff78718eca2fdcd25d856b949ce7">no_threads_terminated</a> ()</td></tr>
<tr class="memdesc:a406fff78718eca2fdcd25d856b949ce7"><td class="mdescLeft">&#160;</td><td class="mdescRight">answers the question "are there no theads terminated?"  <a href="#a406fff78718eca2fdcd25d856b949ce7">More...</a><br /></td></tr>
<tr class="separator:a406fff78718eca2fdcd25d856b949ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ac38ddb1c78cbf5e366ec44850aeb8397"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#ac38ddb1c78cbf5e366ec44850aeb8397">removeTerminated</a> (void **return_val)</td></tr>
<tr class="memdesc:ac38ddb1c78cbf5e366ec44850aeb8397"><td class="mdescLeft">&#160;</td><td class="mdescRight">remove a terminated thread LIFO  <a href="#ac38ddb1c78cbf5e366ec44850aeb8397">More...</a><br /></td></tr>
<tr class="separator:ac38ddb1c78cbf5e366ec44850aeb8397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96843ae9fae3854ab19fb375ae9b8653"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a96843ae9fae3854ab19fb375ae9b8653">addID</a> (pthread_t id, <a class="el" href="structThreadMgr_1_1func__arguments.html">func_arguments</a> *arg)</td></tr>
<tr class="memdesc:a96843ae9fae3854ab19fb375ae9b8653"><td class="mdescLeft">&#160;</td><td class="mdescRight">add a thread id to the id vector  <a href="#a96843ae9fae3854ab19fb375ae9b8653">More...</a><br /></td></tr>
<tr class="separator:a96843ae9fae3854ab19fb375ae9b8653"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a8a37bd86d264e847228d146275693e5f"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a8a37bd86d264e847228d146275693e5f">func</a> (void *arg)</td></tr>
<tr class="memdesc:a8a37bd86d264e847228d146275693e5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">internal thread function  <a href="#a8a37bd86d264e847228d146275693e5f">More...</a><br /></td></tr>
<tr class="separator:a8a37bd86d264e847228d146275693e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dbc71f704d35fd399f3de3c7da9aec8"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a3dbc71f704d35fd399f3de3c7da9aec8">addTerminated</a> (<a class="el" href="classThreadMgr.html">ThreadMgr</a> *arg)</td></tr>
<tr class="memdesc:a3dbc71f704d35fd399f3de3c7da9aec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">add a thread id to the m_terminated stack  <a href="#a3dbc71f704d35fd399f3de3c7da9aec8">More...</a><br /></td></tr>
<tr class="separator:a3dbc71f704d35fd399f3de3c7da9aec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac885cc5e2505221ecf8c605b05ee887b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#ac885cc5e2505221ecf8c605b05ee887b">shutdown_thread</a> (void *arg)</td></tr>
<tr class="memdesc:ac885cc5e2505221ecf8c605b05ee887b"><td class="mdescLeft">&#160;</td><td class="mdescRight">shutdown a thread from pthread_cleanup_pop().  <a href="#ac885cc5e2505221ecf8c605b05ee887b">More...</a><br /></td></tr>
<tr class="separator:ac885cc5e2505221ecf8c605b05ee887b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6ebcc9c89d5467da36c5a99970409016"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a></td></tr>
<tr class="memdesc:a6ebcc9c89d5467da36c5a99970409016"><td class="mdescLeft">&#160;</td><td class="mdescRight">mutex for data access (m_ids, m_terminated)  <a href="#a6ebcc9c89d5467da36c5a99970409016">More...</a><br /></td></tr>
<tr class="separator:a6ebcc9c89d5467da36c5a99970409016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04cbd0e7e6e43261bb0b4bddc364f00c"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">m_cond_mutex</a></td></tr>
<tr class="memdesc:a04cbd0e7e6e43261bb0b4bddc364f00c"><td class="mdescLeft">&#160;</td><td class="mdescRight">mutex for condition variable  <a href="#a04cbd0e7e6e43261bb0b4bddc364f00c">More...</a><br /></td></tr>
<tr class="separator:a04cbd0e7e6e43261bb0b4bddc364f00c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><td class="memItemLeft" align="right" valign="top">pthread_cond_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">m_cond_var</a></td></tr>
<tr class="memdesc:a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">condition variable  <a href="#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">More...</a><br /></td></tr>
<tr class="separator:a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf2d9aea00e3364b3b14333295e2adc"><td class="memItemLeft" align="right" valign="top">std::map&lt; pthread_t, <a class="el" href="structThreadMgr_1_1func__arguments.html">ThreadMgr::func_arguments</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">m_ids</a></td></tr>
<tr class="memdesc:a7bf2d9aea00e3364b3b14333295e2adc"><td class="mdescLeft">&#160;</td><td class="mdescRight">map of all thread ids and function attributes  <a href="#a7bf2d9aea00e3364b3b14333295e2adc">More...</a><br /></td></tr>
<tr class="separator:a7bf2d9aea00e3364b3b14333295e2adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc4ba558ed5fc00fb84aecd586c8e41"><td class="memItemLeft" align="right" valign="top">std::stack&lt; pthread_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a></td></tr>
<tr class="memdesc:acdc4ba558ed5fc00fb84aecd586c8e41"><td class="mdescLeft">&#160;</td><td class="mdescRight">stack of terminated thread ids  <a href="#acdc4ba558ed5fc00fb84aecd586c8e41">More...</a><br /></td></tr>
<tr class="separator:acdc4ba558ed5fc00fb84aecd586c8e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A basic thread management class. </p>
<dl class="section author"><dt>Author</dt><dd>Karl N. Redman (<a href="#" onclick="location.href='mai'+'lto:'+'kar'+'l.'+'red'+'ma'+'n@g'+'ma'+'il.'+'co'+'m'; return false;">karl.<span style="display: none;">.nosp@m.</span>redm<span style="display: none;">.nosp@m.</span>an@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a>)</dd></dl>
<dl class="section user"><dt>Purpose:</dt><dd>This is an example class intended to be used as a guidline for the work required to handle pthreads where the main process (the parent of the initial threads) waits on a condition variable for the threads to terminate. The functions that are specified for the pthread_create are user defined. <br />
 <br />
 This class should be pretty fast and relatively easy to use for most general purpose thread programming. In general, it's a good place to start. <br />
 <br />
 Basic pthread "voidness" has been retained for demonstration purposes. It is concevable that this class could be instantiated from and / or altered to make the user interface easier to work with (in other words -we could get rid of much of the user end casting through inheritance).</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This class is not intended for use by detached threads unless some of the functions are overridden. Also, the use of long casting was used in favor of readability in the interests of speed. </dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00060">60</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afe858b6d5ea9c7acb604c0ff9125acf6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ThreadMgr::ThreadMgr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>constructor </p>
<dl class="section note"><dt>Note</dt><dd>this function instantiates static pthread_x_t variables for mutexes and a condition variable</dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00080">80</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00413">m_cond_mutex</a>, <a class="el" href="threadDeath3_8cc_source.html#l00416">m_cond_var</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  { </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">//the data mutex</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">static</span> pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER; </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a> = &amp;mutex; </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">//the condition variable mutex</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">static</span> pthread_mutex_t cond_mutex = PTHREAD_MUTEX_INITIALIZER;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">m_cond_mutex</a> = &amp;cond_mutex;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//the condition variable</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">static</span> pthread_cond_t cond_var = PTHREAD_COND_INITIALIZER;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">m_cond_var</a> = &amp;cond_var;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><div class="ttname"><a href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">ThreadMgr::m_cond_var</a></div><div class="ttdeci">pthread_cond_t * m_cond_var</div><div class="ttdoc">condition variable </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00416">threadDeath3.cc:416</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
<div class="ttc" id="classThreadMgr_html_a04cbd0e7e6e43261bb0b4bddc364f00c"><div class="ttname"><a href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">ThreadMgr::m_cond_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_cond_mutex</div><div class="ttdoc">mutex for condition variable </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00413">threadDeath3.cc:413</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a96843ae9fae3854ab19fb375ae9b8653"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ThreadMgr::addID </td>
          <td>(</td>
          <td class="paramtype">pthread_t&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structThreadMgr_1_1func__arguments.html">func_arguments</a> *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>add a thread id to the id vector </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00386">386</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00419">m_ids</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00181">createThread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">//lock the data mutex</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    </div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//add the thread to the std::map</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">m_ids</a>.insert(std::make_pair(<span class="keywordtype">id</span>, arg));</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">//unlock the data mutex</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a7bf2d9aea00e3364b3b14333295e2adc"><div class="ttname"><a href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">ThreadMgr::m_ids</a></div><div class="ttdeci">std::map&lt; pthread_t, ThreadMgr::func_arguments * &gt; m_ids</div><div class="ttdoc">map of all thread ids and function attributes </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00419">threadDeath3.cc:419</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dbc71f704d35fd399f3de3c7da9aec8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* ThreadMgr::addTerminated </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadMgr.html">ThreadMgr</a> *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>add a thread id to the m_terminated stack </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00317">317</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00416">m_cond_var</a>, <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00422">m_terminated</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00265">func()</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  { </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//pthread_mutex_lock(((ThreadMgr *)arg)-&gt;m_mutex);</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    pthread_mutex_lock(arg-&gt;<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//add self to list of stuff to be terminated (joined)</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    arg-&gt;<a class="code" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a>.push(pthread_self());</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">//broadcast to threads waiting on the condition variable to notify</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//them to wake up</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    pthread_cond_broadcast(arg-&gt;<a class="code" href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">m_cond_var</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    pthread_mutex_unlock(arg-&gt;<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">//return NULL -blah</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><div class="ttname"><a href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">ThreadMgr::m_cond_var</a></div><div class="ttdeci">pthread_cond_t * m_cond_var</div><div class="ttdoc">condition variable </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00416">threadDeath3.cc:416</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
<div class="ttc" id="classThreadMgr_html_acdc4ba558ed5fc00fb84aecd586c8e41"><div class="ttname"><a href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">ThreadMgr::m_terminated</a></div><div class="ttdeci">std::stack&lt; pthread_t &gt; m_terminated</div><div class="ttdoc">stack of terminated thread ids </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00422">threadDeath3.cc:422</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad731b9dbd261bc4665bad0b40a3db1eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ThreadMgr::cancel_thread </td>
          <td>(</td>
          <td class="paramtype">pthread_t *&#160;</td>
          <td class="paramname"><em>tid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>cancel a thread </p>
<dl class="section return"><dt>Returns</dt><dd>return value of a pthread_cancel() for parameter tid </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tid</td><td>pointer to the thread id to kill</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>If the thread has allocated dynamic memory and has been canceled this class does not compensate. In other words, never cancel a thread (with this class) that allocates dynamic memory -you will lose your pointer. This is because pthread_cancel does not allow you to recieve anything back from a canceled thread. However, you could delete your pointer before you retrurn from the thread if that is your wish.</dd>
<dd>
use of the function pthread_cancel() for threads managed by this class may result in loss of dynamic memory pointers, or worse, a race condition for m_mutex resulting in a deadlock of the threads. Don not use pthread_cancel() for threads managed by this class. Use <a class="el" href="classThreadMgr.html#ad731b9dbd261bc4665bad0b40a3db1eb" title="cancel a thread ">ThreadMgr::cancel_thread()</a> instead.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>add more robust thread canceling ability </dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00100">100</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00419">m_ids</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00448">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//cancel a thread</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);        <span class="comment">//lock the data mutex </span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">m_ids</a>.erase(*tid);                  <span class="comment">//remove from id map</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">//cancel the thread</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ret = pthread_cancel(*tid);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);      <span class="comment">// unlock data mutex</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> ret; </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a7bf2d9aea00e3364b3b14333295e2adc"><div class="ttname"><a href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">ThreadMgr::m_ids</a></div><div class="ttdeci">std::map&lt; pthread_t, ThreadMgr::func_arguments * &gt; m_ids</div><div class="ttdoc">map of all thread ids and function attributes </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00419">threadDeath3.cc:419</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab27dc1197d7c3955d1b7e2a529a0a40e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ThreadMgr::condWait </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>thread_return_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait on a condition variable for a thread to terminate </p>
<dl class="section user"><dt>Purpose: </dt><dd>Act like a seamless condition variable. Allows a process to block until a thread has terminated and returns the thread functions return value through the parameter.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>pointer to the pointer of the threads return value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pthread_join status from <a class="el" href="classThreadMgr.html#ac38ddb1c78cbf5e366ec44850aeb8397" title="remove a terminated thread LIFO ">removeTerminated()</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function may not be safe for threads that are canceled</dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00140">140</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00413">m_cond_mutex</a>, <a class="el" href="threadDeath3_8cc_source.html#l00416">m_cond_var</a>, <a class="el" href="threadDeath3_8cc_source.html#l00251">no_threads_terminated()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00336">removeTerminated()</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00448">main()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00723">TwaitStringThreads()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00656">waitStringThreads()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">//condition variable mutex lock</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">m_cond_mutex</a>);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//check predicate</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">while</span>(<a class="code" href="classThreadMgr.html#a406fff78718eca2fdcd25d856b949ce7">no_threads_terminated</a>())</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">//wait on condition variable</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        pthread_cond_wait(<a class="code" href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">m_cond_var</a>, <a class="code" href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">m_cond_mutex</a>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">//remove the thread from the terminated list (handle join)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ret = <a class="code" href="classThreadMgr.html#ac38ddb1c78cbf5e366ec44850aeb8397">removeTerminated</a>(thread_return_val);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">//unlock</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">m_cond_mutex</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//return join status</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_ac38ddb1c78cbf5e366ec44850aeb8397"><div class="ttname"><a href="classThreadMgr.html#ac38ddb1c78cbf5e366ec44850aeb8397">ThreadMgr::removeTerminated</a></div><div class="ttdeci">int removeTerminated(void **return_val)</div><div class="ttdoc">remove a terminated thread LIFO </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00336">threadDeath3.cc:336</a></div></div>
<div class="ttc" id="classThreadMgr_html_a26e1f1d3ed3eb826ec56fb9d79e6ffbe"><div class="ttname"><a href="classThreadMgr.html#a26e1f1d3ed3eb826ec56fb9d79e6ffbe">ThreadMgr::m_cond_var</a></div><div class="ttdeci">pthread_cond_t * m_cond_var</div><div class="ttdoc">condition variable </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00416">threadDeath3.cc:416</a></div></div>
<div class="ttc" id="classThreadMgr_html_a406fff78718eca2fdcd25d856b949ce7"><div class="ttname"><a href="classThreadMgr.html#a406fff78718eca2fdcd25d856b949ce7">ThreadMgr::no_threads_terminated</a></div><div class="ttdeci">bool no_threads_terminated()</div><div class="ttdoc">answers the question &quot;are there no theads terminated?&quot; </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00251">threadDeath3.cc:251</a></div></div>
<div class="ttc" id="classThreadMgr_html_a04cbd0e7e6e43261bb0b4bddc364f00c"><div class="ttname"><a href="classThreadMgr.html#a04cbd0e7e6e43261bb0b4bddc364f00c">ThreadMgr::m_cond_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_cond_mutex</div><div class="ttdoc">mutex for condition variable </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00413">threadDeath3.cc:413</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classThreadMgr_ab27dc1197d7c3955d1b7e2a529a0a40e_cgraph.png" border="0" usemap="#classThreadMgr_ab27dc1197d7c3955d1b7e2a529a0a40e_cgraph" alt=""/></div>
<map name="classThreadMgr_ab27dc1197d7c3955d1b7e2a529a0a40e_cgraph" id="classThreadMgr_ab27dc1197d7c3955d1b7e2a529a0a40e_cgraph">
<area shape="rect" id="node2" href="classThreadMgr.html#a406fff78718eca2fdcd25d856b949ce7" title="answers the question &quot;are there no theads terminated?&quot; " alt="" coords="222,5,378,47"/>
<area shape="rect" id="node3" href="classThreadMgr.html#ac38ddb1c78cbf5e366ec44850aeb8397" title="remove a terminated thread LIFO " alt="" coords="200,71,400,98"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeed679cee8b5f8308486800e44110299"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t ThreadMgr::createThread </td>
          <td>(</td>
          <td class="paramtype">void *(*)(void *)&#160;</td>
          <td class="paramname"><em>thread_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>attempt to create a new thread and register it </p>
<dl class="section user"><dt>Purpose:</dt><dd>Create a new thread and register it for management by this class.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 on error, pthread_t thread ID on success</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pointer</td><td>to function to run as thread, pointer to argument. [i.e. createThread(myfunc, arg);]</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function works by building the an argument list from the one provided by the user and some internal stuff in order to call an internal function that sets things up for return values, etc. and then calls the users function. This adds about the size of 8 (roughly) pointers to the memory usage of each thread being created -but that's the price for wanting to keep track of this stuff generically i guess.</dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00181">181</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00386">addID()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00072">ThreadMgr::func_arguments::arg</a>, <a class="el" href="threadDeath3_8cc_source.html#l00069">ThreadMgr::func_arguments::cancel_func</a>, <a class="el" href="threadDeath3_8cc_source.html#l00066">ThreadMgr::func_arguments::func</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00075">ThreadMgr::func_arguments::thisObject</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00448">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    pthread_t tid = 0;          <span class="comment">// Id of thread</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> ret_val;                <span class="comment">// return value</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//arguments for the function</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">struct </span>func_arguments *arguments = <span class="keyword">new</span> func_arguments;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    arguments-&gt;func = thread_func;      <span class="comment">// users function</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    arguments-&gt;cancel_func = NULL;      <span class="comment">// NOT IMPLIMENTED</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    arguments-&gt;arg = arg;               <span class="comment">// users argument</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//this is the this pointer (so far, every thread get&#39;s one -eek!)</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    arguments-&gt;thisObject = <span class="keyword">this</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">//create a new thread</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">      default attributes (for now), </span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">      internal function, func(), calls users function,</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">      arguments contain other info + user&#39;s argument.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    ret_val = pthread_create(&amp;tid, (pthread_attr_t *) NULL, <a class="code" href="classThreadMgr.html#a8a37bd86d264e847228d146275693e5f">func</a>, (<span class="keywordtype">void</span> *)arguments);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span>(ret_val == 0)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">//register the thread and arguments in the ids map</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="classThreadMgr.html#a96843ae9fae3854ab19fb375ae9b8653">addID</a>(tid, arguments);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">//return thread id</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> tid;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;pthread_create FAIL&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">//return 0 on error</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a8a37bd86d264e847228d146275693e5f"><div class="ttname"><a href="classThreadMgr.html#a8a37bd86d264e847228d146275693e5f">ThreadMgr::func</a></div><div class="ttdeci">static void * func(void *arg)</div><div class="ttdoc">internal thread function </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00265">threadDeath3.cc:265</a></div></div>
<div class="ttc" id="classThreadMgr_html_a96843ae9fae3854ab19fb375ae9b8653"><div class="ttname"><a href="classThreadMgr.html#a96843ae9fae3854ab19fb375ae9b8653">ThreadMgr::addID</a></div><div class="ttdeci">void addID(pthread_t id, func_arguments *arg)</div><div class="ttdoc">add a thread id to the id vector </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00386">threadDeath3.cc:386</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classThreadMgr_aeed679cee8b5f8308486800e44110299_cgraph.png" border="0" usemap="#classThreadMgr_aeed679cee8b5f8308486800e44110299_cgraph" alt=""/></div>
<map name="classThreadMgr_aeed679cee8b5f8308486800e44110299_cgraph" id="classThreadMgr_aeed679cee8b5f8308486800e44110299_cgraph">
<area shape="rect" id="node2" href="classThreadMgr.html#a96843ae9fae3854ab19fb375ae9b8653" title="add a thread id to the id vector " alt="" coords="221,5,348,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a37bd86d264e847228d146275693e5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* ThreadMgr::func </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>internal thread function </p>
<dl class="section user"><dt>Purpose:</dt><dd>This function is called from the call to pthread_create() within member function createThread. This function handles basic thread management issues and is a wrapper around the user function -which is called from here as well.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>NONE -this function shouldn't return!!! it calls pthread_exit().</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>shold be a pointer to a <a class="el" href="structThreadMgr_1_1func__arguments.html" title="structure for static wrapper function arguments ">func_arguments</a> structure.</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00265">265</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00317">addTerminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00072">ThreadMgr::func_arguments::arg</a>, <a class="el" href="threadDeath3_8cc_source.html#l00069">ThreadMgr::func_arguments::cancel_func</a>, <a class="el" href="threadDeath3_8cc_source.html#l00066">ThreadMgr::func_arguments::func</a>, <a class="el" href="threadDeath3_8cc_source.html#l00399">shutdown_thread()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00075">ThreadMgr::func_arguments::thisObject</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">//convenience this object</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="classThreadMgr.html">ThreadMgr</a> *thisObject = ((<span class="keyword">struct </span>func_arguments *)arg)-&gt;thisObject;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">//return argument from user function</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">void</span> *tmpArg = NULL;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">//basic cancel stuff -should be more robust</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">struct </span>func_arguments *cancel_arg = <span class="keyword">new</span> func_arguments;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    cancel_arg-&gt;cancel_func = <a class="code" href="classThreadMgr.html#ac885cc5e2505221ecf8c605b05ee887b">shutdown_thread</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    cancel_arg-&gt;func = NULL;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    cancel_arg-&gt;arg = NULL;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    cancel_arg-&gt;thisObject = thisObject;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//set the cleanup function</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    pthread_cleanup_push(<a class="code" href="classThreadMgr.html#ac885cc5e2505221ecf8c605b05ee887b">shutdown_thread</a>, (<span class="keywordtype">void</span> *)cancel_arg);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">//call the user&#39;s function</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    tmpArg = ((<span class="keyword">struct </span>func_arguments *)arg)-&gt;func( ((<span class="keyword">struct</span> func_arguments *)arg)-&gt;arg );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;func() passing \&quot;&quot; &lt;&lt; *(std::string *)tmpArg &lt;&lt; &quot;\&quot; to pthread_exit()&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//delete (struct func_arguments *)arg;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">//pop the cleanup handler off the cleanup stack</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">//delete the arg variable list from the createThread function.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    pthread_cleanup_pop(1);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">//add this thread to the terminated list</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    thisObject-&gt;<a class="code" href="classThreadMgr.html#a3dbc71f704d35fd399f3de3c7da9aec8">addTerminated</a>(thisObject);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">//exit this thread</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    pthread_exit(tmpArg);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//we will never get here</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a3dbc71f704d35fd399f3de3c7da9aec8"><div class="ttname"><a href="classThreadMgr.html#a3dbc71f704d35fd399f3de3c7da9aec8">ThreadMgr::addTerminated</a></div><div class="ttdeci">static void * addTerminated(ThreadMgr *arg)</div><div class="ttdoc">add a thread id to the m_terminated stack </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00317">threadDeath3.cc:317</a></div></div>
<div class="ttc" id="classThreadMgr_html_ac885cc5e2505221ecf8c605b05ee887b"><div class="ttname"><a href="classThreadMgr.html#ac885cc5e2505221ecf8c605b05ee887b">ThreadMgr::shutdown_thread</a></div><div class="ttdeci">static void shutdown_thread(void *arg)</div><div class="ttdoc">shutdown a thread from pthread_cleanup_pop(). </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00399">threadDeath3.cc:399</a></div></div>
<div class="ttc" id="classThreadMgr_html"><div class="ttname"><a href="classThreadMgr.html">ThreadMgr</a></div><div class="ttdoc">A basic thread management class. </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00060">threadDeath3.cc:60</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classThreadMgr_a8a37bd86d264e847228d146275693e5f_cgraph.png" border="0" usemap="#classThreadMgr_a8a37bd86d264e847228d146275693e5f_cgraph" alt=""/></div>
<map name="classThreadMgr_a8a37bd86d264e847228d146275693e5f_cgraph" id="classThreadMgr_a8a37bd86d264e847228d146275693e5f_cgraph">
<area shape="rect" id="node2" href="classThreadMgr.html#a3dbc71f704d35fd399f3de3c7da9aec8" title="add a thread id to the m_terminated stack " alt="" coords="171,5,349,32"/>
<area shape="rect" id="node3" href="classThreadMgr.html#ac885cc5e2505221ecf8c605b05ee887b" title="shutdown a thread from pthread_cleanup_pop(). " alt="" coords="186,57,334,98"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a406fff78718eca2fdcd25d856b949ce7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ThreadMgr::no_threads_terminated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>answers the question "are there no theads terminated?" </p>
<dl class="section return"><dt>Returns</dt><dd>boolean of terminated threads in terminate queue</dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00251">251</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00422">m_terminated</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00140">condWait()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00448">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">bool</span> ret = <a class="code" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a>.empty();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
<div class="ttc" id="classThreadMgr_html_acdc4ba558ed5fc00fb84aecd586c8e41"><div class="ttname"><a href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">ThreadMgr::m_terminated</a></div><div class="ttdeci">std::stack&lt; pthread_t &gt; m_terminated</div><div class="ttdoc">stack of terminated thread ids </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00422">threadDeath3.cc:422</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac38ddb1c78cbf5e366ec44850aeb8397"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ThreadMgr::removeTerminated </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>return_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>remove a terminated thread LIFO </p>
<dl class="section return"><dt>Returns</dt><dd>result of pthread_join</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pointer</td><td>to user function return value pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>the void **retrun_val is a result of the pthread_join.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>the thread is unregistered only if the pthread_join was successfull. This may be a problem down the line (but VERY rare)</dd></dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00336">336</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00419">m_ids</a>, <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00422">m_terminated</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00140">condWait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    pthread_t tempID;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//lock critical section</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//make sure we have something</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a>.empty())</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">//get id from stack</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        tempID = <a class="code" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a>.top();</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">//join with the terminated thread</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span>( (ret = pthread_join(tempID, return_val)) == 0)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="comment">//delete the arguments (created in createThread)</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="comment">//delete m_ids.find(tempID)-&gt;second;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">//get rid of the ID from active list</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">m_ids</a>.erase(tempID);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="comment">//remove id from stack</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <a class="code" href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">m_terminated</a>.pop();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;pthread_join() = &quot;</span> &lt;&lt; ret &lt;&lt; std::endl;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">//unlock critical section</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">//return value of pthread_join</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a7bf2d9aea00e3364b3b14333295e2adc"><div class="ttname"><a href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">ThreadMgr::m_ids</a></div><div class="ttdeci">std::map&lt; pthread_t, ThreadMgr::func_arguments * &gt; m_ids</div><div class="ttdoc">map of all thread ids and function attributes </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00419">threadDeath3.cc:419</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
<div class="ttc" id="classThreadMgr_html_acdc4ba558ed5fc00fb84aecd586c8e41"><div class="ttname"><a href="classThreadMgr.html#acdc4ba558ed5fc00fb84aecd586c8e41">ThreadMgr::m_terminated</a></div><div class="ttdeci">std::stack&lt; pthread_t &gt; m_terminated</div><div class="ttdoc">stack of terminated thread ids </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00422">threadDeath3.cc:422</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac885cc5e2505221ecf8c605b05ee887b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ThreadMgr::shutdown_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shutdown a thread from pthread_cleanup_pop(). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>must be void * per pthread_cleanup_x()</td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00399">399</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00265">func()</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">delete</span> ((<span class="keyword">struct </span>func_arguments *)arg);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85b1d99fa66ff17daea44b1defe43810"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ThreadMgr::threadsActive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the number of active threads </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00241">241</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>References <a class="el" href="threadDeath3_8cc_source.html#l00419">m_ids</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00410">m_mutex</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00448">main()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00723">TwaitStringThreads()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00656">waitStringThreads()</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  { </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    pthread_mutex_lock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> ret =  <a class="code" href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">m_ids</a>.size(); </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    pthread_mutex_unlock(<a class="code" href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">m_mutex</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="ttc" id="classThreadMgr_html_a7bf2d9aea00e3364b3b14333295e2adc"><div class="ttname"><a href="classThreadMgr.html#a7bf2d9aea00e3364b3b14333295e2adc">ThreadMgr::m_ids</a></div><div class="ttdeci">std::map&lt; pthread_t, ThreadMgr::func_arguments * &gt; m_ids</div><div class="ttdoc">map of all thread ids and function attributes </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00419">threadDeath3.cc:419</a></div></div>
<div class="ttc" id="classThreadMgr_html_a6ebcc9c89d5467da36c5a99970409016"><div class="ttname"><a href="classThreadMgr.html#a6ebcc9c89d5467da36c5a99970409016">ThreadMgr::m_mutex</a></div><div class="ttdeci">pthread_mutex_t * m_mutex</div><div class="ttdoc">mutex for data access (m_ids, m_terminated) </div><div class="ttdef"><b>Definition:</b> <a href="threadDeath3_8cc_source.html#l00410">threadDeath3.cc:410</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a04cbd0e7e6e43261bb0b4bddc364f00c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t* ThreadMgr::m_cond_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>mutex for condition variable </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00413">413</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00140">condWait()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00080">ThreadMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a26e1f1d3ed3eb826ec56fb9d79e6ffbe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_cond_t* ThreadMgr::m_cond_var</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>condition variable </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00416">416</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00317">addTerminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00140">condWait()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00080">ThreadMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a7bf2d9aea00e3364b3b14333295e2adc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;pthread_t, <a class="el" href="structThreadMgr_1_1func__arguments.html">ThreadMgr::func_arguments</a> *&gt; ThreadMgr::m_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>map of all thread ids and function attributes </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00419">419</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00386">addID()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00100">cancel_thread()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00336">removeTerminated()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00241">threadsActive()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ebcc9c89d5467da36c5a99970409016"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t* ThreadMgr::m_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>mutex for data access (m_ids, m_terminated) </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00410">410</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00386">addID()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00317">addTerminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00100">cancel_thread()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00251">no_threads_terminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00336">removeTerminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00080">ThreadMgr()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00241">threadsActive()</a>.</p>

</div>
</div>
<a class="anchor" id="acdc4ba558ed5fc00fb84aecd586c8e41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::stack&lt;pthread_t&gt; ThreadMgr::m_terminated</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>stack of terminated thread ids </p>

<p>Definition at line <a class="el" href="threadDeath3_8cc_source.html#l00422">422</a> of file <a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a>.</p>

<p>Referenced by <a class="el" href="threadDeath3_8cc_source.html#l00317">addTerminated()</a>, <a class="el" href="threadDeath3_8cc_source.html#l00251">no_threads_terminated()</a>, and <a class="el" href="threadDeath3_8cc_source.html#l00336">removeTerminated()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="threadDeath3_8cc_source.html">threadDeath3.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classThreadMgr.html">ThreadMgr</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
